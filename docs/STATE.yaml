# STATE.yaml v7.6-claude-optimized
# Î»=limitation Ï†=file âˆ‡=implement âˆ…=missing â€ =workaround â€¡=critical âœ“=native
# MACHINE_CONTEXT_FOR_CLAUDE[not_human_readable]

â€¡RTM_AUTH_FLOW[FIXED_2025-07-27]:
  STATUS: âœ“fixed_ux_flowâ†’proper_auth_verification
  â€¡RACE_CONDITION: âœ“fixedâ†’verify_before_callback
  â€¡PRIMARY_ISSUE: âœ“fixedâ†’user_must_complete_rtm_auth_before_continue
  â€¡SOLUTION: /rtm/check-auth_endpointâ†’polls_frob_status_every_2s
  â€¡UX_IMPROVEMENTS: [continue_button_disabled_until_verified,visual_status_feedback,retry_mechanism]
  â€¡NEW_ENDPOINTS: /rtm/check-authâ†’json{authorized:bool,pending:bool,error:string}
  â€¡FLOW_FIXED: intermediate_pageâ†’check_auth_statusâ†’enable_continueâ†’callbackâ†’verified_token
  
âˆ‡RTM_FUTURE_UX[TBD]:
  âˆ‡USER_PROVIDED_CREDENTIALS: require_user_rtm_api_key+secret[not_server_env_vars]
  âˆ‡PERMISSION_SCOPES: [read_only_option,designated_lists_filter,tag_restrictions]
  âˆ‡AUTH_FLOW_REDESIGN: user_inputs_credentialsâ†’scoped_permissionsâ†’rtm_oauth
  RATIONALE: user_owns_credentials+granular_access_control
  DOCUMENTED: Ï†docs/AUTH_FLOWS.yamlâ†’RTM_DEBUG_FINDINGS[2025-07-27]
  ISSUE: âœ“RESOLVED_oauth_tests_failing_with_400
  ROOT_CAUSE: HTML_token_extraction_off_by_one
  PROBLEM: hardcoded_offset_26_incorrect_for_search_string
  FIX: use_len(searchStr)_instead_of_magic_number
  LEARNED: [avoid_magic_numbers,test_string_extraction,debug_first]

â€¡DEV_GUIDELINES:
  SESSION_PROTOCOL: âœ“CHECK_STATE_YAML_FIRSTâ†’machine_optimized_context
  RTFM_MANDATE: âˆ…never_guess[check:STATE.yaml,reference/schema.ts,reference/llms-full.txt,actual_source]
  CODE_STANDARDS: [âœ“replace_not_duplicate,âœ“complete_functions_only,âœ“quality_first,âœ“explicit_gaps>technical_debt]
  TECHNICAL_APPROACH: [âœ“assume_bugs_in_our_code,âœ“streaming_http,âœ“transparency,âœ“unfiltered_counsel]
  VERIFICATION_REQUIRED: [âœ“check_actual_code,âœ“check_documentation,âˆ…never_assume_functionality]
  STATE_YAML_PURPOSE: âœ“machine_optimized_claude_context[not_human_documentation]

âˆžSTATUS:
  MODE: everything_server[tools+resources+promptsâœ“]+debug_proxyâœ“
  BUILD: go build -o bin/cowpilot cmd/cowpilot/main.go
  âœ“BUILD_DEBUG: go build -o bin/mcp-debug-proxy cmd/mcp-debug-proxy/main.go
  RUN: ./bin/cowpilot
  âœ“RUN_DEBUG: make run-debug-proxy
  TEST: npx @modelcontextprotocol/inspector ./bin/cowpilot
  âœ“TEST_DEBUG: npx @modelcontextprotocol/inspector http://localhost:8080
  âœ“TESTING: [testutil.Assertâ†’human_readableâœ“,gotestsumâ†’format_testdoxâœ“,main_testâ†’BDD_scenariosâœ“,make_testâ†’simplifiedâœ“,scenario_outputâ†’descriptiveâœ“,protocol_complianceâ†’comprehensiveâœ“]
  âœ“TEST_SCRIPTS: [Ï†scripts/test/run-tests.shâ†’unified_runner,project-health-checkâœ“,mcp-protocol-smoke-testâœ“,transport-diagnosticsâœ“,debug-integrationâœ“,gotestsum_formattingâœ“,âœ“test-mcp-integration.shâ†’NEW]
  âœ“DEPLOY_SCRIPTS: [Ï†scripts/deploy/deploy-debug-to-fly.shâ†’automated_deployment,check-status.shâ†’health_verification,monitor-registration.shâ†’live_debugging]
  âœ“FIXED_RAW_TEST: [scenario-test-rawâ†’localhost_serverâœ“,makefile_updatedâ†’auto_start_stopâœ“]
  FIXED: [resource_handlerâ†’[]mcp.ResourceContents,prompt_Argumentsâ†’map[string]string,MimeTypeâ†’MIMEType,CallToolRequest.Params.Argumentsâ†’type_assert_map[string]any]âœ“
  CLEANED: [removed_unused_vars(samplePrompts,sampleResources,subscriptions),removed_deprecated_handlers(4),cleaned_comments]âœ“
  âœ“MIGRATION: [removed_internal/mcp+internal/transportâ†’mark3labs/mcp-go_external_library]
  âœ“TESTS_CLEANED: [deleted_broken_integration_testâ†’imports_nonexistent_packages,kept_working_e2e_framework]
  âœ“RESOLVED: go_vet_errorâ†’missing_internal/mcp_package[file_already_removed]
  âœ“DEPLOYMENT: fly.io[single_instance,min_machines_running=1,auth_disabled=true]
  âœ“CLAUDE_REGISTERED: https://cowpilot.fly.dev/mcp[tools_workingâœ“]

âœ“DEBUG_SYSTEM:
  STATUS: âœ“phase1_implementedâ†’âœ“adr012_runtime_config_complete
  PLAN: Ï†docs/debug/mcp-conformance-plan.md
  PROBLEM: âˆ…rigorous_protocol_conformance+debug_capabilities
  PHASES: [âœ“conversation_logging,protocol_validation,security_monitoring,dashboard,automated_testing]
  ARCHITECTURE: âœ“proxy_middleware[non_invasive,optional_enable,minimal_overhead]+âœ“runtime_configuration
  PRIORITY: âˆ‡implement_adr012â†’runtime_debug_config
  ADR: Ï†docs/adr/010-mcp-debug-system-architecture.mdâœ“+Ï†docs/adr/011-conditional-compilation-lightweight-debug.mdâ€ +Ï†docs/adr/012-runtime-debug-configuration.mdâœ“
  STRATEGY: âœ“runtime_configuration[env_vars]+bounded_storage[memory/file]+developer_friendly
  
âœ“PHASE1[conversation_logging]:
  DURATION: completed_july25_2025
  DELIVERABLES: [âœ“internal/debug/interceptor.go,âœ“internal/debug/storage.go,âœ“cmd/mcp-debug-proxy/]
  GOAL: âœ“real_time_mcp_conversation_capture+analysis
  STATUS: âœ“implementedâ†’âˆ‡refactoring_for_runtime_config
  FEATURES: [âœ“sqlite_storage,âœ“message_interceptor,âœ“session_tracking,âœ“performance_monitoring,âœ“debug_proxy_server]
  REFACTOR: âˆ‡runtime_config[MCP_DEBUG=true,bounded_storage,single_build]
  
âœ“PHASE2[protocol_validation]:
  DURATION: 2-3_weeks  
  COMPONENTS: [âœ“json_rpc_validator,âœ“tools_validation,âœ“resources_validation,âœ“prompts_validation_explicit]
  SECURITY: [âœ“parameter_injection_detection,âœ“access_pattern_flagging,âœ“error_sanitization]
  STATUS: âœ“implemented
  
âˆ‡PHASE3[debug_dashboard]:
  TECH_STACK: [react_frontend,websocket_realtime,go_backend_api,chart_js_viz]
  FEATURES: [live_conversation_monitor,protocol_analysis,interactive_testing]
  STATUS: âˆ…pending_phase2
  
Î»MCP-GO:
  VERSION: github.com/mark3labs/mcp-go[current]
  âœ“IMPORT_CHANGE: github.com/vcto/mcp-goâ†’github.com/mark3labs/mcp-go[completed_migration]
  âˆ…MISSING: [SetCompletionHandler,SetLoggingHandler,ProgressNotifications]
  âœ“EXISTS: [NewMCPServer,AddTool,AddResource,AddResourceTemplate,AddPrompt,ServeStdio,NewSSEServer]
  â€¡STREAMABLE_HTTP_SESSION_MANAGEMENT:
    DEFAULT: InsecureStatefulSessionIdManager[uuid_based]
    FLOW: initializeâ†’returns_Mcp-Session-Id_headerâ†’client_must_send_in_subsequent_requests
    VALIDATION: requires_mcp-session-{uuid}_formatâ†’returns_400_invalid_session_id
    STATELESS_MODE: server.WithStateLess(true)â†’no_session_validation
    CUSTOM: implement_SessionIdManager_interface
    IMPACTS: [per_session_tools,logging_levels,sse_notifications]
    SOURCE: /Users/vcto/Projects/mcp-go-main/server/streamable_http.go
  â€¡MCP_INSPECTOR_TRANSPORT:
    AUTO_DETECTION: url_pattern_based[/mcpâ†’http,/sseâ†’sse,defaultâ†’sse]
    CLI_FLAG: only_affects_output_format_not_transport
    FORCE_TRANSPORT: --transport_http|sse|stdio
    ISSUE: default_endpoint_/â†’uses_sse_not_http
    SOLUTIONS: [WithEndpointPath("/mcp"),--transport_http,WithStateLess(true)]
    SOURCE: /Users/vcto/Projects/inspector-main/cli/src/transport.ts
    âœ“DOCUMENTED: Ï†docs/MCP_INSPECTOR_SESSION_ISSUE.md[comprehensive_reference]
  
âˆ‡TOOLS[11]:
  helloâ†’"Hello,World!"
  echo[message:string]â†’"Echo:$message"
  add[a,b:number]â†’a+b
  get_time[format?:unix|iso|human]â†’time.Now()[default:iso]
  base64_encode[text:string]â†’base64(text)
  base64_decode[data:string]â†’decode(data)
  string_operation[text,operation:upper|lower|reverse|length]â†’transform(text)
  format_json[json:string,minify?:bool]â†’prettify|minify
  long_running_operation[duration?,steps?:number]â†’simulate_progress
  get_test_image[]â†’ImageContent{base64,image/png}
  get_resource_content[uri]â†’EmbeddedResource{TextResourceContents|BlobResourceContents}

âœ“RESOURCES[4]:
  example://text/helloâ†’TextResourceContents{text/plain}
  example://text/readmeâ†’TextResourceContents{text/markdown}
  example://image/logoâ†’BlobResourceContents{image/png}
  example://dynamic/{id}â†’TextResourceContents{application/json}[template]

âœ“PROMPTS[2]:
  simple_greetingâ†’PromptMessage{user:greeting_request}
  code_review[language,code:required]â†’PromptMessage{user:review_request}

âœ“NATIVE_SUPPORT:
  RESOURCES: âœ“native{AddResource,AddResourceTemplate,WithResourceCapabilities}
  PROMPTS: âœ“native{AddPrompt,WithPromptCapabilities}
  COMPLETIONS: âˆ…not_implemented
  LOGGING: âˆ…not_implemented
  PROGRESS: âˆ…not_implemented[Î»no_api]

Ï†MAIN: /Users/vcto/Projects/cowpilot/cmd/cowpilot/main.go
  â€¡TRANSPORT: StreamableHTTP[stateless]â†’HTTP_POST+SSE_auto_detect
  âœ“CONFIG: WithStateLess(true)â†’no_sessionsâœ“testing_simplified
  âœ“CLIENTS: [Inspectorâ†’HTTP,Browserâ†’SSE,curlâ†’HTTP]
  âœ“FIXES: [inspector_--transport_http,json_rpc_tests,utc_time]
  PATTERN_TOOL: s.AddTool(mcp.NewTool(name,opts...),handler)
  PATTERN_MULTI: &mcp.CallToolResult{Content:[]interface{}{TextContent{},ImageContent{}}}
  PATTERN_ERROR: mcp.NewToolResultError(msg),nil
  PATTERN_EMBED: EmbeddedResource{Type:"resource",Resource:TextResourceContents{URI,MimeType,Text}}
  âœ“MIDDLEWARE_STACK: [protocolDetectionMiddlewareâ†’debugâ†’authâ†’corsâ†’streamableServer]
  âœ“ENDPOINTS: [/mcp,/health,/oauth/*,/.well-known/*]

â€¡DECISIONS:
  âœ“LIBRARY: mcp-go[native_support]â†’tools+resources+prompts
  âœ“APPROACH: native_api_usage>no_workarounds_needed
  RATIONALE: library_supports_features+clean_implementation
  
â€¡ACTIVE_BLOCKERS: 
  Î»MCP_GO: âˆ…[completions,logging,progress]
  â€¡CLAUDE_AI: âˆ…[OAuth_DCR_testing_needed]
  â€¡OAUTH_CSRF: âœ“csrf_uses_session_cookies[must_copy_cookies_GETâ†’POST]
  â€¡TEST_ISSUES: âœ“fixed[package_conflicts,missing_functions,csrf_cookie_flow]
  â€¡CSRF_ARCHITECTURE_CONFLICT:
    PROBLEM: mixing_two_csrf_approaches[server_side_tokens+cookies]
    CURRENT: stateTokens_map_in_OAuthCallbackServer[in_memory_not_shared]
    ATTEMPTED: added_cookies_but_still_validating_against_memory_map
    ROOT_CAUSE: ValidateStateToken_checks_s.stateTokens[state]_not_cookie
    SOLUTION: pick_one_approach[prefer_cookies_for_stateless_deployment]
    LEARNED: [rtfm_before_changing,understand_data_flow,avoid_mixing_patterns]

SAMPLE_DATA:
  RES: {
    "example://text/hello": "Hello,World!This is a simple text resource from the everything server.",
    "example://text/readme": "# Everything Server\n\nThis is an example MCP server...",
    "example://image/logo": "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="
  }
  PROMPTS: {
    "simple_greeting": {args:âˆ…,msg:"Please provide a friendly greeting for a new user joining our community."},
    "code_review": {args:{language:required,code:required},msg:"Please review the following $language code..."}
  }

â€¡CLAUDE_AI_INTEGRATION[2025-07-27]:
  GOAL: âœ“enable_claude.ai_as_MCP_client[completed]
  â€¡CONSTRAINT: claude.ai_CANNOT_access_local_servers[browser_security]
  âœ“DEPLOYED: fly.io[auth_disabled,single_instance]
  âœ“REGISTERED: claude.ai_connector[tools_visibleâœ“]
  
  âœ“P1_REMOTE_DEPLOYMENT[COMPLETE_2025-07-26]:
    STATUS: âœ“fly.io_deployed+âœ“CORS_implementedâ†’âˆ‡healthcheck_needed
    DELIVERABLES: [âœ“CORS_headers,âœ“health_endpoint,âœ“SSE_test_script]
    CORS_CONFIG: âœ“Access-Control-Allow-Origin:https://claude.ai
    CORS_IMPL: âœ“internal/middleware/cors.go[configurable_origins]
    TEST_SCRIPT: âœ“scripts/test/test-sse-transport.sh
    DOCS: âœ“docs/claude-integration/[README,deployment,troubleshooting]
    â€¡FLY_HEALTH: âœ“fixed[removed_experimental_cmd,startup_race_fixed,cors_bypass]
    READY_FOR: deployment+claude.ai_testing[pending_OAuth]
    
  âœ“P2_OAUTH_IMPLEMENTATION[COMPLETE_2025-07-26]:
    STATUS: âœ“implementedâ†’testing_needed
    DELIVERABLES: [âœ“oauth_adapter,âœ“callback_server,âœ“middleware,âœ“csrf_protection]
    IMPLEMENTED:
      CALLBACK_SERVER: [âœ“timeouts,âœ“multiple_paths,âœ“graceful_shutdown]
      SECURITY: [âœ“csrf_tokens,âœ“one_time_use,âœ“token_expiry]
      MIDDLEWARE: [âœ“auth_bypass_for_oauth,âœ“bearer_validation]
      TESTS: [âœ“40+_unit_tests,âœ“scenario_tests,âœ“naming_convention]
    ISSUES_FIXED: [âœ“compilation_errors,âœ“linter_violations,âœ“unexported_fields]
    READY_FOR: claude.ai_integration_testing
    
  âœ“P3_INTEGRATION_TEST[COMPLETE_2025-07-26]:
    DELIVERABLES: [âœ“tests/claude_connector_test.go,âˆ‡CI_integration]
    COVERAGE: [âœ“OAuth_flow,âœ“tool_calls,âœ“SSE_transport,âœ“error_handling,âœ“CORS_compliance,âœ“naming_compliance]
    FEATURES: [âœ“complete_oauth_simulation,âœ“sse_transport_verification,âœ“tool_execution,âœ“capability_discovery,âœ“error_scenarios]
    STATUS: âœ“test_file_createdâ†’needs_execution_verification
    
  CONSTRAINTS:
    NAMING: no_punctuation_in_connector_name[spaces_OK]
    DESCRIPTION: >30_characters_required
    CONFIG: string_values_only[no_nested_objects]
    TRANSPORT: SSE+Streamable_HTTP_required

âˆ‡PROTOCOL_CONTRACTS[2025-07-26]:
  STATUS: âœ“implementedâ†’fixing_integration_tests
  Ï†internal/contracts/: [oauth.go,oauth_test_helpers.go,middleware.go,oauth_test.go]
  Ï†docs/reference/oauth-protocol-requirements.md: detailed_spec
  â€¡OAUTH_REQUIREMENTS:
    GET_AUTHORIZE: [client_id,redirect_uri,state]â†’query_params
    POST_AUTHORIZE: [client_id,csrf_state,client_state,api_key]â†’form_body_NOT_query
    â€¡CSRF_FLOW: GET_sets_cookieâ†’POST_must_include_cookie
    TOKEN_ENDPOINT: [grant_type=authorization_code,code]â†’form_body
    BEARER_FORMAT: "Authorization: Bearer <token>"â†’space_required
  LEARNED:
    FORM_VS_QUERY: POST_params_must_be_in_form_body[common_mistake]
    COOKIE_JAR: tests_need_http.Client.Jar_for_csrf_cookies
    CONTRACT_TESTING: proactive_validation>reactive_debugging

âˆ‡DOCUMENTATION_PLAN:
  Ï†docs/claude-integration/
    âˆ‡README.md: overview+quickstart
    âˆ‡oauth-implementation.md: [flow_diagrams,token_management,refresh_logic]
    âˆ‡troubleshooting.md: [common_errors,debug_steps,inspector_usage]
    âˆ‡deployment.md: [fly.io_config,env_vars,monitoring]
  Ï†docs/reference/
    âˆ‡oauth2_examples/: SDK_reference_implementations
    âˆ‡claude_api_spec.md: callback_URLs,requirements
  EXISTING_SOLUTIONS:
    AUTH: [Cloudflare_MCP_hosting,Auth0_integration,Azure_APIM]
    EXAMPLES: [TypeScript_SDK,Python_SDK,fastmcp+mcpauth]
    PATTERNS: [DCR_flow,token_refresh,PKCE]

âˆ‡NEXT:
  â€¡PRIORITY1: âœ“MCP_foundation_testing[critical_brick]
    IMPLEMENTED:
      1. âœ“tests/mcp_integration_test.goâ†’comprehensive_coverage
      2. âœ“scripts/test/test-mcp-integration.shâ†’automated_runner
      3. âœ“fly.tomlâ†’single_instance_config
      4. âœ“auth_disabledâ†’simplified_testing
    RATIONALE: foundational_capability_must_be_maintained
    TEST_COVERAGE: [tools/listâœ“,tools/callâœ“,resources/listâœ“,resources/readâœ“,prompts/listâœ“]
    â€¡TEST_STRATEGY: integration_tests_run_against_DEPLOYED_instance[https://cowpilot.fly.dev/mcp]
    DOCUMENTED: Ï†docs/TEST_STRATEGY.md[âœ“clear_distinction_local_vs_deployed]
  â€¡PRIORITY2: âœ“RTM_OAuth_bridge[frob_to_oauth_fixed]
    FIXED:
      1. âœ“dynamic_redirect_uriâ†’uses_actual_callback_from_request
      2. âœ“csrf_cookie_flowâ†’consistent_implementation
      3. âœ“session_trackingâ†’preserves_all_oauth_params
      4. âœ“api_signatureâ†’proper_frob_auth_url
      5. âœ“auto_popupâ†’better_ux_flow
      6. âœ“TokenResponse_typesâ†’added_auth/types.go
    LEARNED: [preserve_oauth_params,use_actual_redirect_uri,consistent_csrf_flow]
  PRIORITY3: âœ“persistent_token_storage[SQLite_implemented]
    IMPLEMENTED:
      1. âœ“TokenStoreInterfaceâ†’swappable_implementations
      2. âœ“SQLiteTokenStoreâ†’persistent_with_WAL_mode
      3. âœ“CreateTokenStoreâ†’factory_with_env_config
      4. âœ“fly_volumeâ†’cowpilot_data_at_/data
      5. âœ“automatic_cleanupâ†’24hr_expiry
    CONFIG: TOKEN_DB_PATH=/data/tokens.db
    DEPLOYMENT: fly volumes create cowpilot_data --size 1
  PRIORITY4: âœ“runtime_protocol_validation[via_debug_proxy]
    IMPLEMENTED:
      1. âœ“ValidateProto_configâ†’MCP_VALIDATE_PROTOCOL=true
      2. âœ“ValidateModeâ†’monitor|enforce  
      3. âœ“validation_integration.goâ†’uses_protocol/validation
      4. âœ“Validation_storageâ†’violations_table+stats
      5. âœ“Zero_overheadâ†’when_disabled
    ENV_VARS: [MCP_VALIDATE_PROTOCOL,MCP_VALIDATE_MODE]
    VALIDATION: ValidatedMessageInterceptor+ValidationEngine
  PRIORITY5: âˆ‡monitoring[usage_metrics]
  COMPLETED: [âœ“fly_deployment,âœ“claude_registration,âœ“auth_disabled,âœ“integration_tests]
  DEFERRED: [oauth_with_persistence,completions]
  
  âœ“IMPLEMENTED: [fly.io_deployment,CORS_middleware,protocol_validation,11_tools]
  âˆ‡REFACTOR: [implement_OAuth2,add_auth_endpoints]
  OPTIONS: [âˆ‡implement_OAuthâ€¡|test_without_auth|research_Cloudflare_MCP]
  
â€¡VERIFY:
  âœ“tools.len==11
  âœ“echo("test")=="Echo: test"
  âœ“add(2,3)==5
  âœ“string_operation("hello","upper")=="HELLO"
  âœ“base64_encode("test")==base64_decode("dGVzdA==")
  âœ“get_test_image().Content[1].Type=="image"
  âœ“resources.list().includes("example://text/hello")
  âœ“prompts.get("code_review",{language:"go",code:"..."}).includes("review")
  âœ“get_resource_content("example://image/logo").Content[1].Type=="resource"
  âœ“FIXED: resource_handlersâ†’return[]mcp.ResourceContents[interface]

â‰ˆCONTEXT[current_session_july27_2025]:
  âœ“DEPLOYMENT: fly.io[single_instance,auth_disabled,persistent_tokens]
  âœ“INTEGRATION_TESTS: all_passingâ†’deployed_instance
  âœ“COMPLETED: [P1_mcp_testsâœ“,P2_rtm_oauthâœ“,P3_sqlite_tokensâœ“,P4_validationâœ“]
  âœ“PRODUCTION: persistent_volume[/data/tokens.db]+validation_ready
  âˆ‡NEXT_OPTIONS: [RTM_credentialsâ†’fly_secrets,claude_ai_testing,practical_tools]
  CONFIDENCE: ðŸŸ¢PRODUCTION_STABLE
  
âœ“SESSION_VALIDATED[july26_2025]:
  STATUS: ðŸŸ¢PRODUCTION_READY
  GUIDELINES_REVIEWED: âœ“session_protocol_acknowledged
  MAINTENANCE_FOCUS: âœ“state_yaml_optimization_for_claude_performance
  BUILD: âœ“clean_dependencies,âœ“comprehensive_tests,âœ“active_deployment
  âœ“IMPLEMENTED: [WithStateLess(true),timeHandler_UTC_fix,inspector_--transport_http,test_logic_fixes]
  âœ“DOCUMENTED: Ï†docs/MCP_INSPECTOR_SESSION_ISSUE.md[comprehensive_reference]
  CONFIDENCE: HIGHâ†’session_management_resolved
  NEXT: [fix_csrf_session_cookies|verify_tests_pass|âˆ‡implement_adr012_runtime_config|production_hardening]
  
â€¡CONFIRMED_INSPECTOR_LIMITATION[2025-07-25]:
  FACT: MCP_Inspector_CANNOT_pass_tool_arguments_to_URL_servers
  ERROR_MSG: "Arguments cannot be passed to URL-based MCP server"
  TESTED: [echo,add,base64_encode,string_operationâ†’ALL_FAIL]
  ROOT_CAUSE: inspector_design_limitation_not_bug
  âœ“SOLUTION: use_raw_JSON_RPC_via_curl_for_ALL_tool_tests_with_arguments
  DECISION: âˆ…DO_NOT_REVISITâ†’documented_permanent_limitation
  PATTERN: tools_without_argsâ†’use_inspector|tools_with_argsâ†’use_curl_json_rpc

â€¡FILES_STRUCTURE[2025-07-27]:
  cmd/cowpilot/: [main.go,main_test.go]â†’primary_server
  cmd/mcp-debug-proxy/: main.goâ†’debug_proxy
  internal/auth/: [oauth_adapter.go,middleware.go,token_store.go,csrf_token_test.go,oauth_callback_server.go]
  internal/debug/: [config.go,interceptor.go,storage.go,validation_integration.go]
  internal/middleware/: cors.go
  internal/rtm/: [client.go]â†’NEW_STARTED
  internal/validator/: [core.go,jsonrpc.go,mcp.go,security.go]
  internal/testutil/: [assertions.go,requests.go]
  internal/contracts/: [oauth.go,oauth_test_helpers.go,middleware.go,oauth_test.go]
  tests/: [claude_connector_test.go,oauth_scenario_test.go,test-runner.go,mcp_integration_test.goâ†’NEW]
  scripts/test/: [run-tests.sh,test-sse-transport.sh,test-mcp-integration.shâ†’NEW]
  docs/: [STATE.yaml,adr/*,claude-integration/*,debug/*,reference/*,oauth-protocol-requirements.md]
